---
layout: post
title: C#开发.Net Framework
subtitle: 这是基于.Net Framework框架开发的C#程序的经历
date: 2019-09-27
author: Cofal
header-img: img/2020/01/04/title-bg.jpg
music: { type: "0", id: "804408604" }
catalog: true
related: true
tags:
    - C#
    - .Net Framework
---

> ### 闲扯
>
> > &emsp;在写这个过程之前我先说一下接触这个小项目的事情。大概是我从这个项目中学到的事情吧。虽然这个才是我想写这个博客的正事，但是还是放到引用后面别那么显眼吧。
>
> ##### 1. 报价
>
> &emsp;之前看过一个插画师拍的一个关于插画报价的视频，当时只是觉得对方的观点说的很好，[av73016525](https://www.bilibili.com/video/av73016525)，大概就是你不用觉得自己做的东西值得多少报价，而是看对面愿意出多少。这次的接单让我觉得这个观点相当的正确！
>
> &emsp;项目要求将选定的代码还有一份对方根据这个测试代码做出来的分析文件解析一下生成一份 Word 报表。代码文件的大小根据需求应该是被限定在 200K 之下，那么这就是一个很简单的任务。
>
> &emsp;刚开始我为这个项目估价大概是**1000 ￥**，我觉得大概这么多钱就可以接下来做，毕竟整个项目的估计时间也不是很久，大概需要两天就可以写完（虽然最后实际写了四天多）。因为我觉得自己报价一天 500 ￥已经算是很高，对得起自己的实际付出。
>
> &emsp;如果最后就是这个价格我也不会有这个感慨，最后对方给出的报价是**10000 ￥**……后来发现这个项目其实也是外包的，这个项目的最终客户是政府机构，果然国家的钱好骗啊，我这个小小的几十 KB 大小的软件就能让我获得将近十倍的溢价，这还是外包一次之后的价格。之前还在吐槽那群骗国家钱开发国产系统的人怎么想的，现在知道……
>
> &emsp;由于对面是需要严格保密的机构，这篇博客也不会透露任何的软件的页面和内容。那么写出来的内容就会局限于代码中被剔除了的部分。还要吐槽一句，由于是外包，给我这个单的公司不能把原来的测试文件给我，可以想象一下我在没有原文件给我解析的情况下做这种软件的难度（主要难度就是这个……）。
>
> ##### 2. 需求分析
>
> &emsp;相信大家多多少少接触过软件开发的相关课程，都学过或者听说过编写需求分析，当时学这个的时候可能很多人都和我一样觉得，这种东西不就是糊弄人的么，随便写写看起来高大上一点。然后没有学会怎么写需求分析。
>
> &emsp;不幸的是自己成为我抱有的这种想法的受害者。这个项目的需求分析对面一共给了四个版本，懂？我总计开发了四天，也就是说其实我每次更改代码基本上都是因为对面更改了需求分析，所以才需要更改代码（实际上不是）。
>
> &emsp;第一版的需求分析让我不敢相信这是一个对方开发过一个完整的项目，之后我知道对方开发的程序被对方否决，总算觉得安心。第一版中问题各种各样，先不说标点这种吹毛求疵的问题，单是对应的序号缺失，配图配字有错我就和对方聊很久。
>
> &emsp;之后的版本中逐渐修改了这些问题，但是我还是想问对方界面设计上面的有两个按键有啥用？和前一个开发这个项目的开发人员交流之后，对面也想不到那两个按键的存在理由……吐血 ing。没有一个好的开发需求为难开发人员了。
>
> ##### 3. 程序鲁棒性
>
> &emsp;之前写代码都是考虑自己想好的输入，从来不去考虑客户怎么输入。甚至自己做的网站和数据库，知道半年前才知道还可以 SQL 注入，之前都没有好好的考虑过这些。实际开发过程中让我知道用户会做出很多自己没有想到的操作，实际的电脑中会有很多的问题出现，必须要好好的做好程序的鲁棒性。
>
> &emsp;初期做报表的工作，由于我第一个找到的是 COM 包——`Microsof.Office.Interop.Word`,觉得很简单，没有顾和前开发人员交流的数据库报表功能。欸，不听老人言，吃亏在眼前。
>
> &emsp;由于是 Word 的 COM 包，最后是调用 Microsoft Office Word 的相关功能，也就是说我最后做的任何修改都是要通过 Word 来操作的，这就带来一个很大的问题，那就是操作的延时导致部分操作出错还有就是速度实在是慢的不要不要的，大概生成一个文档需要半分钟的等待时间，还会出现各种各样的 bug，还会出现不同的 Office 版本文档的产出速度完全两样，比如 2013 下产生相同的文档之需要 7 秒左右，2019 却需要半分钟……
>
> &emsp;之后为了解决这个问题我耗费了一天半的时间写一个 Word 操作类，直接用自己的代码生成 Word（懒得再去采用第三方库）。之后看看协议可不可以透漏部分代码，如果可以我打算把这个简单的 Word 操作类开源。如果不可以，那我就花点时间把这部分代码改改，改成一个 DLL 编译结果的版本开源了（反正是个 flag，咱已经不知道多少个 flag 没有做了，债多了不愁），这个操作使得原来的半分钟时间，变成了现在的毫秒，还有鲁棒性也大大提高。

# 第一次接触 Csharp

&emsp;&emsp;首先推荐一个学习语言和开发技术的网站[runoob.com](https://www.runoob.com/)，一般自己需要入门一门语言都会到这个网站上面简单学习一下，然后就去做一些简单的开发，然后再不断的修改自己的代码。

&emsp;&emsp;使用 C#不是我的本愿啊， 谁让我再开发之前嘴贱的问：有限定开发语言嘛？然后我就被要求使用 Csharp 同时还需要限定在 .Net Framework 框架下，之前虽然看过 Csharp，但是熟悉程度远远达不上开发程序的程度。

&emsp;&emsp;学习 Csharp 过程之后我觉得 Csharp 我简直爱了！第一次接触委托这种思想，之后我打算利用寒假开发的微机芯片模拟器，就可以利用委托来很好的实现，目前我还是希望最后的成品可以是网页程序，方便使用和传播。之后我试着可不可以用 JavaScript 的底层挥着一些 Model 做出类似委托的实现，如果可以那么就确认制作网页程序，不然到时候再使用 Csharp 开发吧（这是不是又是一个 flag）。

&emsp;&emsp;我一直在思考一个问题，那就是安装 Visual Studio 的时候自带一个程序，打开以后和 Visual Studio 长得基本上一致。一直以为那是……一个轻量版的 VS，对不起，当年的我太年轻，这次我才知道这是前端设计程序。

&emsp;&emsp;我也不知道这个 Blender for Visual Studio 有没有过时，但是这个让我接触到之前就一直知道但是没有实现的 MVC 模型，好吧我就知道这个模型好不……

![url-des]({{ site.baseurl }}/img/2020/01/04/1.png)

&emsp;&emsp;回头更新。
